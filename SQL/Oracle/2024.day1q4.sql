CREATE TABLE SAILOR (
    SID NUMBER PRIMARY KEY, 
    SNAME VARCHAR(20), 
    RATING NUMBER, 
    AGE NUMBER
);

CREATE TABLE BOAT (
    BID NUMBER PRIMARY KEY, 
    BNAME VARCHAR(20), 
    COLOR VARCHAR(6), 
    CHECK (COLOR IN ('RED', 'GREEN', 'BLUE'))
);

CREATE TABLE RESERVES (
    SID NUMBER REFERENCES SAILOR, 
    BID NUMBER REFERENCES BOAT, 
    DAY DATE
);

INSERT INTO SAILOR VALUES (1, 'Ravi', 5, 25);
INSERT INTO SAILOR VALUES (2, 'Biplab', 6, 30);
INSERT INTO SAILOR VALUES (3, 'Amit', 4, 22);
INSERT INTO SAILOR VALUES (4, 'Bittu', 8, 28);
INSERT INTO SAILOR VALUES (5, 'Bb', 7, 31);
INSERT INTO SAILOR VALUES (6, 'Bhairab', 5, 35);

INSERT INTO BOAT VALUES (1, 'Sea Breeze', 'RED');
INSERT INTO BOAT VALUES (2, 'Ocean Blue', 'BLUE');
INSERT INTO BOAT VALUES (3, 'Green Pearl', 'GREEN');
INSERT INTO BOAT VALUES (4, 'Red Tide', 'RED');
INSERT INTO BOAT VALUES (5, 'Green Glory', 'GREEN');

INSERT INTO RESERVES VALUES (1, 1, '01-SEP-2024');
INSERT INTO RESERVES VALUES (1, 2, '01-SEP-2024');
INSERT INTO RESERVES VALUES (2, 3, '02-SEP-2024');
INSERT INTO RESERVES VALUES (2, 5, '03-SEP-2024');
INSERT INTO RESERVES VALUES (3, 1, '03-SEP-2024');
INSERT INTO RESERVES VALUES (3, 3, '01-SEP-2024');
INSERT INTO RESERVES VALUES (4, 4, '04-SEP-2024');
INSERT INTO RESERVES VALUES (4, 1, '04-SEP-2024');
INSERT INTO RESERVES VALUES (5, 5, '05-SEP-2024');
INSERT INTO RESERVES VALUES (6, 2, '06-SEP-2024');

SELECT * FROM SAILOR;
SELECT * FROM BOAT;
SELECT * FROM RESERVES;

-- Q1
SELECT S.SID, S.SNAME, S.RATING, COUNT(DISTINCT R.BID) AS BOAT_COUNT 
FROM SAILOR S, RESERVES R 
WHERE S.SID = R.SID
GROUP BY S.SID, S.SNAME, S.RATING, R.DAY
HAVING COUNT(DISTINCT R.BID) > 1;

-- Q2
SELECT SNAME 
FROM SAILOR, BOAT, RESERVES 
WHERE SAILOR.SID = RESERVES.SID AND 
      BOAT.BID = RESERVES.BID AND 
      COLOR = 'RED'
INTERSECT
SELECT SNAME 
FROM SAILOR, BOAT, RESERVES 
WHERE SAILOR.SID = RESERVES.SID AND 
      BOAT.BID = RESERVES.BID AND 
      COLOR = 'GREEN';

-- Q3
SELECT AGE 
FROM SAILOR 
WHERE LOWER(SNAME) LIKE 'b%b' AND LENGTH(SNAME) >=3;

-- DROP TABLE RESERVES;
-- DROP TABLE BOAT;
-- DROP TABLE SAILOR;