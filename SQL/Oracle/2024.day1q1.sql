CREATE TABLE HOTEL (
    H_NO NUMBER PRIMARY KEY, 
    H_NAME VARCHAR(20), 
    CITY VARCHAR(20)
);

CREATE TABLE ROOM (
    R_NO NUMBER, 
    H_NO NUMBER REFERENCES HOTEL, 
    TYPE VARCHAR(20), 
    PRICE_PER_DAY NUMBER, 
    PRIMARY KEY ()
);

CREATE TABLE GUEST (
    G_NO NUMBER PRIMARY KEY, 
    G_NAME VARCHAR(20), 
    G_ADDRESS VARCHAR(50)
);

CREATE TABLE BOOKING (
    H_NO NUMBER REFERENCES HOTEL, 
    G_NO NUMBER REFERENCES GUEST, 
    DATE_FROM DATE, 
    DATE_TO DATE, 
    ROOM_NO NUMBER, 
    FOREIGN KEY (ROOM_NO) REFERENCES ROOM(R_NO)
);

INSERT INTO HOTEL VALUES (1, 'TAJ HOTEL', 'Mumbai');
INSERT INTO HOTEL VALUES (2, 'OBEROI', 'Delhi');
INSERT INTO HOTEL VALUES (3, 'LEELA', 'Bangalore');
INSERT INTO HOTEL VALUES (4, 'HYATT', 'Kolkata');
INSERT INTO HOTEL VALUES (5, 'MARRIOTT', 'Pune');

SELECT * FROM HOTEL;

INSERT INTO ROOM VALUES (101, 1, 'AC', 2000);
INSERT INTO ROOM VALUES (102, 1, 'AC', 1500);
INSERT INTO ROOM VALUES (103, 1, 'Non-AC', 1000);
INSERT INTO ROOM VALUES (104, 2, 'AC', 1800);
INSERT INTO ROOM VALUES (105, 2, 'Non-AC', 1200);
INSERT INTO ROOM VALUES (106, 3, 'AC', 2500);
INSERT INTO ROOM VALUES (107, 4, 'AC', 2200);
INSERT INTO ROOM VALUES (108, 5, 'Non-AC', 1100);
INSERT INTO ROOM VALUES (109, 5, 'AC', 900);
INSERT INTO ROOM VALUES (110, 5, 'AC', 700);

SELECT * FROM ROOM;

INSERT INTO GUEST VALUES (1, 'John Doe', 'New York');
INSERT INTO GUEST VALUES (2, 'Jane Smith', 'London');
INSERT INTO GUEST VALUES (3, 'Amit Sharma', 'Delhi');
INSERT INTO GUEST VALUES (4, 'Priya Nair', 'Mumbai');
INSERT INTO GUEST VALUES (5, 'Rahul Singh', 'Jaipur');
INSERT INTO GUEST VALUES (6, 'Anjali Menon', 'Kochi');
INSERT INTO GUEST VALUES (7, 'Ravi Kumar', 'Chennai');
INSERT INTO GUEST VALUES (8, 'Sunita Reddy', 'Hyderabad');
INSERT INTO GUEST VALUES (9, 'Deepak Patil', 'Pune');
INSERT INTO GUEST VALUES (10, 'Neha Gupta', 'Lucknow');
INSERT INTO GUEST VALUES (11, 'Vikram Joshi', 'Ahmedabad');
INSERT INTO GUEST VALUES (12, 'Suman Das', 'Kolkata');
INSERT INTO GUEST VALUES (13, 'Rakesh Verma', 'Bhopal');
INSERT INTO GUEST VALUES (14, 'Meera Iyer', 'Bangalore');
INSERT INTO GUEST VALUES (15, 'Arjun Desai', 'Surat');
INSERT INTO GUEST VALUES (16, 'Kavita Thakur', 'Indore');
INSERT INTO GUEST VALUES (17, 'Nikhil Mehta', 'Nagpur');
INSERT INTO GUEST VALUES (18, 'Swati Pandey', 'Varanasi');
INSERT INTO GUEST VALUES (19, 'Rajesh Pillai', 'Thiruvananthapuram');
INSERT INTO GUEST VALUES (20, 'Sneha Rao', 'Visakhapatnam');

SELECT * FROM GUEST;

INSERT INTO BOOKING VALUES (1, 1, '15-MAR-2016', '20-DEC-2016', 101);
INSERT INTO BOOKING VALUES (1, 2, '05-APR-2016', '10-APR-2016', 104);
INSERT INTO BOOKING VALUES (5, 3, '10-JUN-2016', '15-JUN-2016', 107);
INSERT INTO BOOKING VALUES (1, 4, '01-JUL-2016', '05-JUL-2016', 110);
INSERT INTO BOOKING VALUES (1, 5, '20-MAR-2016', '25-DEC-2016', 102);
INSERT INTO BOOKING VALUES (2, 6, '15-APR-2016', '20-APR-2016', 103);
INSERT INTO BOOKING VALUES (3, 7, '05-MAY-2016', '10-MAY-2016', 106);
INSERT INTO BOOKING VALUES (3, 8, '25-AUG-2016', '30-AUG-2016', 109);
INSERT INTO BOOKING VALUES (4, 9, '10-SEP-2016', '15-SEP-2016', 102);
INSERT INTO BOOKING VALUES (4, 10, '01-OCT-2016', '05-OCT-2016', 105);
INSERT INTO BOOKING VALUES (1, 11, '20-MAR-2016', '25-DEC-2016', 102);
INSERT INTO BOOKING VALUES (5, 12, '10-DEC-2016', '15-DEC-2016', 101);

SELECT * FROM BOOKING;

-- Q1
SELECT GUEST.* 
FROM GUEST, HOTEL, BOOKING 
WHERE GUEST.G_NO = BOOKING.G_NO AND 
      BOOKING.H_NO = HOTEL.H_NO AND 
      H_NAME = 'TAJ HOTEL' AND 
      TO_CHAR(DATE_FROM, 'MON/YYYY') = 'MAR/2016' AND 
      TO_CHAR(DATE_TO, 'MON/YYYY') = 'DEC/2016' AND 
      ROOM_NO = 102;

-- Q2
SELECT ROOM.* 
FROM ROOM, HOTEL 
WHERE ROOM.H_NO = HOTEL.H_NO AND
      TYPE = 'AC' AND 
      PRICE_PER_DAY < 2000;

-- DROP TABLE BOOKING;
-- DROP TABLE GUEST;
-- DROP TABLE ROOM;
-- DROP TABLE HOTEL;