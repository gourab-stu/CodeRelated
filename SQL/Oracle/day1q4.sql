CREATE TABLE STUDENTS (
    SID NUMBER PRIMARY KEY, 
    NAME VARCHAR(20), 
    ADDRESS VARCHAR(50)
);

CREATE TABLE DEPARTMENT (
    DID NUMBER PRIMARY KEY, 
    D_NAME VARCHAR(20)
);

CREATE TABLE PROFESSOR (
    PID NUMBER PRIMARY KEY, 
    NAME VARCHAR(20), 
    AGE NUMBER, 
    D_ID NUMBER REFERENCES DEPARTMENT, 
    POSITION VARCHAR(20),
    CHECK (POSITION = 'HOD' OR POSITION = 'Assistant Professor')
);

CREATE TABLE COURSE (
    C_NO NUMBER PRIMARY KEY, 
    C_NAME VARCHAR(20)
);

CREATE TABLE TAKE (
    SID NUMBER REFERENCES STUDENTS, 
    C_NO NUMBER REFERENCES COURSE, 
    MARKS NUMBER
);

CREATE TABLE TEACH (
    PID NUMBER REFERENCES PROFESSOR, 
    C_NO NUMBER REFERENCES COURSE, 
    D_ID NUMBER REFERENCES DEPARTMENT
);

INSERT INTO STUDENTS VALUES (1, 'Alice', '123 Main St');
INSERT INTO STUDENTS VALUES (2, 'Bob', '456 Maple St');
INSERT INTO STUDENTS VALUES (3, 'Charlie', '789 Oak St');
INSERT INTO STUDENTS VALUES (4, 'David', '101 Pine St');
INSERT INTO STUDENTS VALUES (5, 'Eva', '102 Pine St');
INSERT INTO STUDENTS VALUES (6, 'Frank', '103 Pine St');
INSERT INTO STUDENTS VALUES (7, 'Grace', '104 Pine St');
INSERT INTO STUDENTS VALUES (8, 'Henry', '105 Pine St');
INSERT INTO STUDENTS VALUES (9, 'Ivy', '106 Pine St');
INSERT INTO STUDENTS VALUES (10, 'Jack', '107 Pine St');
INSERT INTO STUDENTS VALUES (11, 'Karen', '108 Pine St');
INSERT INTO STUDENTS VALUES (12, 'Leo', '109 Pine St');
INSERT INTO STUDENTS VALUES (13, 'Mia', '110 Pine St');
INSERT INTO STUDENTS VALUES (14, 'Nina', '111 Pine St');
INSERT INTO STUDENTS VALUES (15, 'Oscar', '112 Pine St');
INSERT INTO STUDENTS VALUES (16, 'Paul', '113 Pine St');
INSERT INTO STUDENTS VALUES (17, 'Quinn', '114 Pine St');
INSERT INTO STUDENTS VALUES (18, 'Rita', '115 Pine St');
INSERT INTO STUDENTS VALUES (19, 'Sam', '116 Pine St');
INSERT INTO STUDENTS VALUES (20, 'Tina', '117 Pine St');
INSERT INTO STUDENTS VALUES (21, 'Uma', '118 Pine St');
INSERT INTO STUDENTS VALUES (22, 'Vera', '119 Pine St');
INSERT INTO STUDENTS VALUES (23, 'Will', '120 Pine St');
INSERT INTO STUDENTS VALUES (24, 'Xena', '121 Pine St');
INSERT INTO STUDENTS VALUES (25, 'Yara', '122 Pine St');
INSERT INTO STUDENTS VALUES (26, 'Zack', '123 Pine St');
INSERT INTO STUDENTS VALUES (27, 'Anna', '124 Pine St');
INSERT INTO STUDENTS VALUES (28, 'Ben', '125 Pine St');
INSERT INTO STUDENTS VALUES (29, 'Cara', '126 Pine St');
INSERT INTO STUDENTS VALUES (30, 'Dylan', '127 Pine St');

SELECT * FROM STUDENTS;

INSERT INTO DEPARTMENT VALUES (1, 'Computer Science');
INSERT INTO DEPARTMENT VALUES (2, 'Mathematics');
INSERT INTO DEPARTMENT VALUES (3, 'Physics');
INSERT INTO DEPARTMENT VALUES (4, 'Electronics');

SELECT * FROM DEPARTMENT;

INSERT INTO PROFESSOR VALUES (1, 'Prof. Smith', 45, 1, 'HOD');
INSERT INTO PROFESSOR VALUES (2, 'Prof. Johnson', 50, 2, 'HOD');
INSERT INTO PROFESSOR VALUES (3, 'Prof. Williams', 40, 3, 'Assistant Professor');
INSERT INTO PROFESSOR VALUES (4, 'Prof. Brown', 55, 4, 'Assistant Professor');
INSERT INTO PROFESSOR VALUES (5, 'Prof. Taylor', 35, 1, 'Assistant Professor');
INSERT INTO PROFESSOR VALUES (6, 'Prof. Anderson', 60, 2, 'Assistant Professor');
INSERT INTO PROFESSOR VALUES (7, 'Prof. Thomas', 50, 3, 'HOD');
INSERT INTO PROFESSOR VALUES (8, 'Prof. Jackson', 45, 4, 'HOD');
INSERT INTO PROFESSOR VALUES (9, 'Prof. White', 38, 1, 'Assistant Professor');
INSERT INTO PROFESSOR VALUES (10, 'Prof. Harris', 48, 2, 'Assistant Professor');

SELECT * FROM PROFESSOR;

INSERT INTO COURSE VALUES (1, 'CS1 Hons');
INSERT INTO COURSE VALUES (2, 'CS2 Hons');
INSERT INTO COURSE VALUES (3, 'CS3 Hons');
INSERT INTO COURSE VALUES (4, 'PHS1 Hons');
INSERT INTO COURSE VALUES (5, 'PHS2 Hons');

SELECT * FROM COURSE;

INSERT INTO TAKE VALUES (1, 1, 85);
INSERT INTO TAKE VALUES (2, 2, 90);
INSERT INTO TAKE VALUES (3, 3, 75);
INSERT INTO TAKE VALUES (4, 4, 80);
INSERT INTO TAKE VALUES (5, 5, 70);
INSERT INTO TAKE VALUES (6, 1, 95);
INSERT INTO TAKE VALUES (7, 2, 85);
INSERT INTO TAKE VALUES (8, 3, 88);
INSERT INTO TAKE VALUES (9, 4, 92);
INSERT INTO TAKE VALUES (10, 5, 87);
INSERT INTO TAKE VALUES (11, 1, 77);
INSERT INTO TAKE VALUES (12, 2, 80);
INSERT INTO TAKE VALUES (13, 3, 89);
INSERT INTO TAKE VALUES (14, 4, 94);
INSERT INTO TAKE VALUES (15, 5, 73);
INSERT INTO TAKE VALUES (16, 1, 68);
INSERT INTO TAKE VALUES (17, 2, 83);
INSERT INTO TAKE VALUES (18, 3, 91);
INSERT INTO TAKE VALUES (19, 4, 95);
INSERT INTO TAKE VALUES (20, 5, 76);
INSERT INTO TAKE VALUES (21, 1, 85);
INSERT INTO TAKE VALUES (22, 2, 88);
INSERT INTO TAKE VALUES (23, 3, 79);
INSERT INTO TAKE VALUES (24, 4, 93);
INSERT INTO TAKE VALUES (25, 5, 81);
INSERT INTO TAKE VALUES (26, 1, 78);
INSERT INTO TAKE VALUES (27, 2, 85);
INSERT INTO TAKE VALUES (28, 3, 90);
INSERT INTO TAKE VALUES (29, 4, 77);
INSERT INTO TAKE VALUES (30, 5, 82);

SELECT * FROM TAKE;

INSERT INTO TEACH VALUES (1, 1, 1);
INSERT INTO TEACH VALUES (2, 2, 2);
INSERT INTO TEACH VALUES (2, 3, 1);
INSERT INTO TEACH VALUES (2, 5, 4);
INSERT INTO TEACH VALUES (3, 3, 3);
INSERT INTO TEACH VALUES (4, 4, 4);
INSERT INTO TEACH VALUES (5, 5, 1);
INSERT INTO TEACH VALUES (6, 1, 2);
INSERT INTO TEACH VALUES (7, 2, 3);
INSERT INTO TEACH VALUES (8, 3, 4);
INSERT INTO TEACH VALUES (8, 2, 4);
INSERT INTO TEACH VALUES (9, 4, 1);
INSERT INTO TEACH VALUES (10, 5, 2);

SELECT * FROM TEACH;

-- Q1
SELECT NAME 
FROM STUDENTS 
WHERE SID IN (SELECT SID 
              FROM TAKE 
              WHERE C_NO = (SELECT C_NO 
                            FROM COURSE 
                            WHERE C_NAME = 'CS3 Hons'));

-- Q2
SELECT NAME 
FROM (SELECT NAME, COUNT(*) AS C1 
      FROM PROFESSOR P, TEACH T 
      WHERE P.PID = T.PID AND 
            P.POSITION = 'HOD' 
      GROUP BY NAME)
WHERE C1 = (SELECT MAX(C2) 
            FROM (SELECT NAME, COUNT(*) AS C2 
                  FROM PROFESSOR P, TEACH T 
                  WHERE P.PID = T.PID AND 
                        P.POSITION = 'HOD' 
                  GROUP BY NAME));

-- DROP TABLE TEACH;
-- DROP TABLE TAKE;
-- DROP TABLE COURSE;
-- DROP TABLE PROFESSOR;
-- DROP TABLE DEPARTMENT;
-- DROP TABLE STUDENTS;